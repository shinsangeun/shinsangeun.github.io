{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/python/opencv-example","result":{"data":{"markdownRemark":{"id":"9aa469a6-b7eb-5bca-b31e-46aaff7acccd","html":"<p>안녕하세요!  </p>\n<p>이번 포스팅에서는 <code class=\"language-text\">OpenCV</code>를 사용 해서 <strong>이미지 인식</strong>을 통해 <strong>얼굴만 사각형</strong>으로 표시 하는 방법을 포스팅 해보 려고 합니다.<br>\n아래 예제를 실행 하면서 발생한 에러와 해결 방안에 대해 정리한 내용은 <a href=\"https://shinsangeun.github.io/categories/Python/cv2-install\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">👉🏻여기</a> 를 참고해 주세요!</p>\n<ul>\n<li>출처: <code class=\"language-text\">파이선을 이용한 머신러닝, 딥러닝 실전 개발 입문</code> 책에 있는 예제를 사용 하였습니다.</li>\n</ul>\n<hr>\n<h3 id=\"개발-환경\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD\" aria-label=\"개발 환경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개발 환경</h3>\n<ul>\n<li>개발 툴: Jupyter notebook</li>\n<li>Python 버전: 3.8.5</li>\n<li>필요한 라이브러리: cv2, sys</li>\n</ul>\n<h3 id=\"코드-설명\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-%EC%84%A4%EB%AA%85\" aria-label=\"코드 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>코드 설명</h3>\n<ul>\n<li>아래 코드는 <a href=\"https://github.com/shinsangeun/PythonStudy/tree/master/Opencv\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">👉🏻Github</a> 에서 볼 수 있습니다.</li>\n<li>\n<p>실습에 필요한 <code class=\"language-text\">sys</code>, <code class=\"language-text\">cv2</code> 라이브러리를 import 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\nsys<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'/usr/local/lib/python3.9/site-packages'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">import</span> cv2</code></pre></div>\n</li>\n<li>\n<p>테스트 할 경로에 이미지 파일을 저장 하고 해당 경로의 이미지를 가져옵니다.<br>\n(저는 같은 경로에 <code class=\"language-text\">soccer.jpg</code>라는 이미지 파일을 저장 하였습니다.) </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">image_file <span class=\"token operator\">=</span> <span class=\"token string\">\"./soccer.jpg\"</span>\n<span class=\"token comment\"># Documents/Github/PythonExample/Opencv</span></code></pre></div>\n</li>\n<li>\n<p>이미지 인식을 위해 <code class=\"language-text\">haarcascade_frontface.xml</code> 파일을 불러 옵니다.<br>\n(이 때, 해당 경로에 저 xml 파일이 없으면 에러가 나므로 꼭 저장해 주셔야 합니다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">cascade_file <span class=\"token operator\">=</span> <span class=\"token string\">\"./haarcascade_frontface.xml\"</span></code></pre></div>\n</li>\n<li>\n<p>이미지를 읽어서 인식합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">image <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>image_file<span class=\"token punctuation\">)</span>\nimage_gs <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2GRAY<span class=\"token punctuation\">)</span>\ncascade <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>CascadeClassifier<span class=\"token punctuation\">(</span>cascade_file<span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n<li>\n<p>불러온 이미지 안에 감지된 사람의 얼굴이 몇명 인지 확인 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">faces <span class=\"token operator\">=</span> cascade<span class=\"token punctuation\">.</span>detectMultiScale<span class=\"token punctuation\">(</span>image_gs<span class=\"token punctuation\">,</span> <span class=\"token number\">1.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"감지된 사람:\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>faces<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n<li>\n<p>사람의 얼굴이 1명일 때, 2명이상 일 경우 명령어를 다르게 입력합니다. 2명이상 일 때는 더 정교한 파라미터로 수정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 사람 1명 일 때</span>\nface_list <span class=\"token operator\">=</span> cascade<span class=\"token punctuation\">.</span>detectMultiScale<span class=\"token punctuation\">(</span>image_gs<span class=\"token punctuation\">,</span> scaleFactor<span class=\"token operator\">=</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> minNeighbors<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> minSize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"face_list 길이:\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>face_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 사람 2명 이상 일 때</span>\nface_list <span class=\"token operator\">=</span> cascade<span class=\"token punctuation\">.</span>detectMultiScale<span class=\"token punctuation\">(</span>image_gs<span class=\"token punctuation\">,</span> scaleFactor<span class=\"token operator\">=</span><span class=\"token number\">1.1</span><span class=\"token punctuation\">,</span> minNeighbors<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> minSize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> maxSize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"face_list 길이:\"</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>face_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n<li>\n<p>불러온 이미지 안에 인식된 사람의 얼굴을 사각형으로 표시 합니다.<br>\n사각형으로 표시된 이미지는 <code class=\"language-text\">facedetect-output.PNG</code>라는 이름으로 새로 이미지가 저장 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>face_list<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>face_list<span class=\"token punctuation\">)</span>\ncolor <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> face <span class=\"token keyword\">in</span> face_list<span class=\"token punctuation\">:</span>\n    x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">,</span>h <span class=\"token operator\">=</span> face\n    <span class=\"token comment\"># 사각형 그리기</span>\n    cv2<span class=\"token punctuation\">.</span>rectangle<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">+</span>w<span class=\"token punctuation\">,</span> y<span class=\"token operator\">+</span>h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> color<span class=\"token punctuation\">,</span> thickness<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\ncv2<span class=\"token punctuation\">.</span>imwrite<span class=\"token punctuation\">(</span><span class=\"token string\">\"facedetect-output.PNG\"</span><span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"no face\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"결과\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC\" aria-label=\"결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결과</h3>\n<ul>\n<li>\n<p>실행 전</p>\n<ul>\n<li>1명일 때: 요즘 가장 핫한 배우인 <code class=\"language-text\">김선호</code>님의 이미지를 사용해 보았습니다..😆<br>\n<img src=\"static/images/python/kimseonho.png\" alt=\"김선호\"> </li>\n<li>2명이상 일 때: 여러명의 이미지로 쓰기 좋은 축구단 이미지를 사용해 보았습니다..😆<br>\n<img src=\"static/images/python/soccer.png\" alt=\"soccer\"></li>\n</ul>\n</li>\n<li>\n<p>실행 후</p>\n<ul>\n<li>1명일 때<br>\n<img src=\"static/images/python/kimseonho_result.png\" alt=\"김선호_result\"> </li>\n<li>2명이상 일 때<br>\n<img src=\"static/images/python/soccer_result.png\" alt=\"soccer_result\"></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"마치며\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마치며</h3>\n<p>Python의 <strong>OpenCV</strong> 라이브러리를 이용해서 생각보다 쉽게 이미지 인식을 해볼 수 있었습니다!<br>\n여러분도 직접 해보시면서 재미있게 느끼셨으면 좋겠습니다.</p>\n<hr>\n<p>오늘 준비한 내용은 여기까지 입니다.<br>\n이번 포스팅이 도움이 되셨거나 궁금한 점이 있으시다면 언제든지 댓글을 달아주세요!🙋🏻‍♀️✨    </p>","fields":{"slug":"/posts/python/opencv-example","tagSlugs":["/tag/python/","/tag/open-cv/"]},"frontmatter":{"date":"2020-12-08 12:52:24","description":"이번 포스팅에서는 `OpenCV`를 사용 해서 이미지 인식을 통해 얼굴만 사각형으로 표시 하는 방법을 포스팅 해보 려고 합니다.","tags":["Python","OpenCV"],"title":"[Python] OpenCV를 이용한 이미지 얼굴 인식","socialImage":null}}},"pageContext":{"slug":"/posts/python/opencv-example"}},"staticQueryHashes":["251939775","401334301","825871152"]}